---
layout: base
eleventyExcludeFromCollections: true
---

<input id="search-input" type="text" placeholder="Search..." autofocus onkeyup="handleSearch()" />
<div id="search-result"></div>

<script>
    const searchResult = document.querySelector("#search-result")
    
    const allPages = {{collections.all | simplifyCollection}};

    handleSearch = () => {
        const search = document.querySelector("#search-input").value?.toLowerCase();
        if (!search || search.length < 2) {
            return
        }
        searchResult.innerHTML = ""
        const filtered = allPages.filter(entry => entry.title?.toLowerCase().includes(search) || entry.tags?.toString().toLowerCase().includes(search) || entry.templateContent?.toLowerCase().includes(search))
        if (!filtered.length) {
            searchResult.innerHTML = `<i>No matches for ${search}...</i>`
            return;
        }
        for (const hit of filtered) {
            console.log(hit)
            const hitDiv = document.createElement('div');
            hitDiv.innerHTML = `<div class="search-result-entry"><a class="search-result-entry-title" href="${hit.url}">${hit.tags ? `${hit.tags} -> ` : ""}${hit.title || hit.url}</a><span>${hit.templateContent}</span></div>`
            searchResult.appendChild(hitDiv)
        }
    }
</script>
